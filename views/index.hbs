<div style="display: grid; place-items: center; min-height: 60vh;">
    <div
        style="background: var(--card-bg); padding: 2rem; border-radius: 8px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); width: 100%; max-width: 400px;">
        <h2 style="margin-top: 0;">Login</h2>
        <form id="loginForm" style="display: flex; flex-direction: column; gap: 1rem;">
            <div>
                <label for="username" style="display: block; margin-bottom: 0.5rem;">Username</label>
                <input type="text" id="username" name="username" required
                    style="width: 100%; padding: 0.5rem; border: 1px solid #ddd; border-radius: 4px;">
            </div>
            <div>
                <label for="password" style="display: block; margin-bottom: 0.5rem;">Password</label>
                <input type="password" id="password" name="password" required
                    style="width: 100%; padding: 0.5rem; border: 1px solid #ddd; border-radius: 4px;">
            </div>
            <button type="submit"
                style="background: var(--primary); color: white; padding: 0.75rem; border: none; border-radius: 4px; cursor: pointer; font-weight: 500;">Sign
                In</button>
        </form>
        <p id="errorMsg" style="color: red; display: none; margin-top: 1rem;">Invalid credentials</p>
    </div>
</div>

<script>
    document.getElementById('loginForm').addEventListener('submit', async (e) => {
        e.preventDefault();
        const formData = new FormData(e.target);
        const data = Object.fromEntries(formData);
        console.log("beforeSendData", data);
        try {
            const res = await fetch('/auth/login', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data),
            });
            console.log("afterSendData", res);
            if (res.ok) {
                window.location.href = '/files/browser'; // Redirect to browser on success
            } else {
                document.getElementById('errorMsg').style.display = 'block';
            }
        } catch (err) {
            console.error(err);
            document.getElementById('errorMsg').style.display = 'block';
        }
    });
</script>